<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Blocknet Paper Wallet</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{background:#0a0a0a;color:#ccc;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;min-height:100vh;display:flex;flex-direction:column;align-items:center;padding:40px 20px}

.screen-ui{display:block;text-align:center}
h1{color:#af0;font-size:28px;font-weight:700;letter-spacing:-0.5px;margin-bottom:6px}
.sub{color:#555;font-size:12px;margin-bottom:32px}
.sub a{color:#af0;text-decoration:none}
.badge{display:inline-block;background:#0a1a00;border:1px solid #1a2a00;color:#af0;font-size:9px;font-weight:700;letter-spacing:1.5px;padding:3px 10px;margin-bottom:24px}
.btn{background:#af0;color:#000;border:none;padding:14px 48px;font-size:15px;font-weight:700;font-family:inherit;cursor:pointer;letter-spacing:0.5px;transition:all .15s;margin-bottom:28px}
.btn:hover{background:#cf4}
.btn:active{transform:scale(.98)}
.btn-sm{padding:10px 28px;font-size:12px}
.btn-outline{background:transparent;color:#af0;border:1px solid #af0}
.btn-outline:hover{background:#af0;color:#000}
.actions{display:flex;gap:10px;justify-content:center;margin-top:16px}

/* === THE NOTE === */
.note{display:none;width:780px;aspect-ratio:2.4/1;background:#000;border:2px solid #af0;position:relative;overflow:hidden}
.note.visible{display:block}

/* guilloche border */
.note::before{content:'';position:absolute;inset:6px;border:1px solid #1a2a00;border-radius:2px;pointer-events:none;z-index:1}
.note::after{content:'';position:absolute;inset:12px;border:1px solid #0d1a00;pointer-events:none;z-index:1}

/* corner ornaments */
.corner{position:absolute;width:28px;height:28px;border:2px solid #af0;z-index:2;opacity:.5}
.corner-tl{top:16px;left:16px;border-right:none;border-bottom:none}
.corner-tr{top:16px;right:16px;border-left:none;border-bottom:none}
.corner-bl{bottom:16px;left:16px;border-right:none;border-top:none}
.corner-br{bottom:16px;right:16px;border-left:none;border-top:none}

.note-body{position:relative;z-index:3;padding:24px 28px;height:100%;display:flex;flex-direction:column;justify-content:space-between}

/* header */
.note-header{display:flex;align-items:center;justify-content:space-between}
.note-brand{display:flex;align-items:center;gap:10px}
.note-brand svg{width:32px;height:32px}
.note-title{color:#af0;font-size:11px;font-weight:700;letter-spacing:3px;text-transform:uppercase}
.note-serial{color:#333;font-size:9px;letter-spacing:1px}

/* seed grid */
.seed-area{flex:1;display:flex;align-items:center;justify-content:center}
.seed-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:4px 8px}
.seed-word{display:flex;align-items:baseline;gap:5px;padding:3px 0}
.seed-num{color:#333;font-size:9px;min-width:14px;text-align:right}
.seed-txt{color:#ddd;font-size:12px;letter-spacing:.5px}

/* key strip */
.key-strip{display:flex;flex-direction:column;gap:3px;border-top:1px solid #1a1a00;padding-top:8px}
.key-row{display:flex;align-items:baseline;gap:8px}
.key-label{color:#af0;font-size:8px;font-weight:700;letter-spacing:1.5px;text-transform:uppercase;min-width:56px;flex-shrink:0}
.key-label.danger{color:#f44}
.key-val{color:#888;font-size:9px;word-break:break-all;line-height:1.4;letter-spacing:.3px}
.key-val.addr{color:#af0;font-size:10px}

/* watermark logo */
.watermark{position:absolute;right:28px;top:50%;transform:translateY(-50%);opacity:.04;z-index:0;pointer-events:none}
.watermark svg{width:200px;height:200px}

/* footer line */
.note-footer{display:flex;justify-content:space-between;align-items:flex-end;margin-top:4px}
.note-footer-left{color:#222;font-size:8px;letter-spacing:1px}
.note-footer-right{color:#222;font-size:8px;letter-spacing:1px}

/* === PRINT === */
@media print{
  body{background:#fff;padding:0}
  .screen-ui{display:none!important}
  .note{display:block!important;border-color:#000;margin:0 auto}
  .note::before{border-color:#888}
  .note::after{border-color:#bbb}
  .corner{border-color:#000}
  .note-title{color:#000}
  .seed-txt{color:#000}
  .key-val{color:#444}
  .key-val.addr{color:#000}
  .key-label{color:#000}
  .key-label.danger{color:#c00}
  .seed-num{color:#888}
  .note-serial{color:#888}
  .key-strip{border-color:#ccc}
  .watermark{opacity:.06}
  .watermark svg rect{fill:#000!important}
  .watermark svg path{fill:#000!important}
  .note-footer-left,.note-footer-right{color:#aaa}
}
</style>
</head>
<body>

<div class="screen-ui">
  <svg width="44" height="44" viewBox="0 0 864 864" style="margin-bottom:14px">
    <rect width="864" height="864" fill="#af0" rx="96"/>
    <path d="M666.35,567.2H197.65c-53.02,0-96,44.21-96,98.74s42.98,98.74,96,98.74h468.71c53.02,0,96-44.21,96-98.74s-42.98-98.74-96-98.74Z"/>
    <path d="M729.79,359.36l-225.26-225.26c-17.75-20.03-43.67-32.66-72.54-32.66-53.51,0-96.89,43.38-96.89,96.89,0,24.97,9.44,47.72,24.95,64.9l-.17.17,240.69,240.69.18-.18c17.17,15.46,39.89,24.87,64.81,24.87,53.51,0,96.89-43.38,96.89-96.89,0-28.87-12.63-54.79-32.66-72.54Z"/>
  </svg>
  <h1>Blocknet Paper Wallet</h1>
  <p class="sub">Offline key generation &mdash; <a href="https://github.com/blocknetprivacy">blocknetprivacy</a></p>
  <button class="btn" onclick="generate()">Generate New Wallet</button>
</div>

<div class="note" id="note">
  <div class="corner corner-tl"></div>
  <div class="corner corner-tr"></div>
  <div class="corner corner-bl"></div>
  <div class="corner corner-br"></div>

  <div class="watermark">
    <svg viewBox="0 0 864 864">
      <rect width="864" height="864" fill="#af0" rx="96"/>
      <path fill="#000" d="M666.35,567.2H197.65c-53.02,0-96,44.21-96,98.74s42.98,98.74,96,98.74h468.71c53.02,0,96-44.21,96-98.74s-42.98-98.74-96-98.74Z"/>
      <path fill="#000" d="M729.79,359.36l-225.26-225.26c-17.75-20.03-43.67-32.66-72.54-32.66-53.51,0-96.89,43.38-96.89,96.89,0,24.97,9.44,47.72,24.95,64.9l-.17.17,240.69,240.69.18-.18c17.17,15.46,39.89,24.87,64.81,24.87,53.51,0,96.89-43.38,96.89-96.89,0-28.87-12.63-54.79-32.66-72.54Z"/>
    </svg>
  </div>

  <div class="note-body">
    <div class="note-header">
      <div class="note-brand">
        <svg viewBox="0 0 864 864">
          <rect width="864" height="864" fill="#af0" rx="96"/>
          <path d="M666.35,567.2H197.65c-53.02,0-96,44.21-96,98.74s42.98,98.74,96,98.74h468.71c53.02,0,96-44.21,96-98.74s-42.98-98.74-96-98.74Z"/>
          <path d="M729.79,359.36l-225.26-225.26c-17.75-20.03-43.67-32.66-72.54-32.66-53.51,0-96.89,43.38-96.89,96.89,0,24.97,9.44,47.72,24.95,64.9l-.17.17,240.69,240.69.18-.18c17.17,15.46,39.89,24.87,64.81,24.87,53.51,0,96.89-43.38,96.89-96.89,0-28.87-12.63-54.79-32.66-72.54Z"/>
        </svg>
        <div class="note-title">Blocknet Paper Wallet</div>
      </div>
      <div class="note-serial" id="serial"></div>
    </div>

    <div class="seed-area">
      <div class="seed-grid" id="seed-grid"></div>
    </div>

    <div class="key-strip">
      <div class="key-row">
        <span class="key-label">Address</span>
        <span class="key-val addr" id="k-addr"></span>
      </div>
      <div class="key-row">
        <span class="key-label danger">Spend Key</span>
        <span class="key-val" id="k-spend"></span>
      </div>
      <div class="key-row">
        <span class="key-label danger">View Key</span>
        <span class="key-val" id="k-view"></span>
      </div>
    </div>

    <div class="note-footer">
      <div class="note-footer-left" id="gen-date"></div>
      <div class="note-footer-right">BNT &bull; RISTRETTO255 &bull; BIP39</div>
    </div>
  </div>
</div>

<div class="screen-ui actions" id="actions" style="display:none">
  <button class="btn btn-outline btn-sm" onclick="window.print()">Print</button>
  <button class="btn btn-sm" onclick="generate()">Generate Another</button>
</div>

<script id="noble-crypto">var noble=(()=>{var At=Object.defineProperty;var Je=Object.getOwnPropertyDescriptor;var tn=Object.getOwnPropertyNames;var en=Object.prototype.hasOwnProperty;var nn=(e,t)=>{for(var n in t)At(e,n,{get:t[n],enumerable:!0})},rn=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of tn(t))!en.call(e,o)&&o!==n&&At(e,o,{get:()=>t[o],enumerable:!(r=Je(t,o))||r.enumerable});return e};var on=e=>rn(At({},"__esModule",{value:!0}),e);var Un={};nn(Un,{bytesToHex:()=>j,hexToBytes:()=>X,pbkdf2:()=>$e,ristretto255:()=>Fe,sha256:()=>xe,sha512:()=>be});function It(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Z(e,t=""){if(!Number.isSafeInteger(e)||e<0){let n=t&&`"${t}" `;throw new Error(`${n}expected integer >= 0, got ${e}`)}}function v(e,t,n=""){let r=It(e),o=e?.length,s=t!==void 0;if(!r||s&&o!==t){let c=n&&`"${n}" `,f=s?` of length ${t}`:"",i=r?`length=${o}`:`type=${typeof e}`;throw new Error(c+"expected Uint8Array"+f+", got "+i)}return e}function ht(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");Z(e.outputLen),Z(e.blockLen)}function rt(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function te(e,t){v(e,void 0,"digestInto() output");let n=t.outputLen;if(e.length<n)throw new Error('"digestInto() output" expected to be of length >='+n)}function M(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function ot(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function V(e,t){return e<<32-t|e>>>t}var ee=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",sn=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function j(e){if(v(e),ee)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=sn[e[n]];return t}var Y={_0:48,_9:57,A:65,F:70,a:97,f:102};function Jt(e){if(e>=Y._0&&e<=Y._9)return e-Y._0;if(e>=Y.A&&e<=Y.F)return e-(Y.A-10);if(e>=Y.a&&e<=Y.f)return e-(Y.a-10)}function X(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(ee)return Uint8Array.fromHex(e);let t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let r=new Uint8Array(n);for(let o=0,s=0;o<n;o++,s+=2){let c=Jt(e.charCodeAt(s)),f=Jt(e.charCodeAt(s+1));if(c===void 0||f===void 0){let i=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+i+'" at index '+s)}r[o]=c*16+f}return r}function cn(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function vt(e,t=""){return typeof e=="string"?cn(e):v(e,void 0,t)}function ne(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options must be object or undefined");return Object.assign(e,t)}function Lt(e,t={}){let n=(o,s)=>e(s).update(o).digest(),r=e(void 0);return n.outputLen=r.outputLen,n.blockLen=r.blockLen,n.create=o=>e(o),Object.assign(n,t),Object.freeze(n)}var Rt=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});function re(e,t,n){return e&t^~e&n}function oe(e,t,n){return e&t^e&n^t&n}var ct=class{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,n,r,o){this.blockLen=t,this.outputLen=n,this.padOffset=r,this.isLE=o,this.buffer=new Uint8Array(t),this.view=ot(this.buffer)}update(t){rt(this),v(t);let{view:n,buffer:r,blockLen:o}=this,s=t.length;for(let c=0;c<s;){let f=Math.min(o-this.pos,s-c);if(f===o){let i=ot(t);for(;o<=s-c;c+=o)this.process(i,c);continue}r.set(t.subarray(c,c+f),this.pos),this.pos+=f,c+=f,this.pos===o&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){rt(this),te(t,this),this.finished=!0;let{buffer:n,view:r,blockLen:o,isLE:s}=this,{pos:c}=this;n[c++]=128,M(this.buffer.subarray(c)),this.padOffset>o-c&&(this.process(r,0),c=0);for(let a=c;a<o;a++)n[a]=0;r.setBigUint64(o-8,BigInt(this.length*8),s),this.process(r,0);let f=ot(t),i=this.outputLen;if(i%4)throw new Error("_sha2: outputLen must be aligned to 32bit");let u=i/4,h=this.get();if(u>h.length)throw new Error("_sha2: outputLen bigger than state");for(let a=0;a<u;a++)f.setUint32(4*a,h[a],s)}digest(){let{buffer:t,outputLen:n}=this;this.digestInto(t);let r=t.slice(0,n);return this.destroy(),r}_cloneInto(t){t||=new this.constructor,t.set(...this.get());let{blockLen:n,buffer:r,length:o,finished:s,destroyed:c,pos:f}=this;return t.destroyed=c,t.finished=s,t.length=o,t.pos=f,o%n&&t.buffer.set(r),t}clone(){return this._cloneInto()}},K=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);var L=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var xt=BigInt(4294967295),se=BigInt(32);function fn(e,t=!1){return t?{h:Number(e&xt),l:Number(e>>se&xt)}:{h:Number(e>>se&xt)|0,l:Number(e&xt)|0}}function ie(e,t=!1){let n=e.length,r=new Uint32Array(n),o=new Uint32Array(n);for(let s=0;s<n;s++){let{h:c,l:f}=fn(e[s],t);[r[s],o[s]]=[c,f]}return[r,o]}var Ht=(e,t,n)=>e>>>n,Ot=(e,t,n)=>e<<32-n|t>>>n,J=(e,t,n)=>e>>>n|t<<32-n,tt=(e,t,n)=>e<<32-n|t>>>n,ft=(e,t,n)=>e<<64-n|t>>>n-32,at=(e,t,n)=>e>>>n-32|t<<64-n;function G(e,t,n,r){let o=(t>>>0)+(r>>>0);return{h:e+n+(o/2**32|0)|0,l:o|0}}var ce=(e,t,n)=>(e>>>0)+(t>>>0)+(n>>>0),fe=(e,t,n,r)=>t+n+r+(e/2**32|0)|0,ae=(e,t,n,r)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0),ue=(e,t,n,r,o)=>t+n+r+o+(e/2**32|0)|0,de=(e,t,n,r,o)=>(e>>>0)+(t>>>0)+(n>>>0)+(r>>>0)+(o>>>0),le=(e,t,n,r,o,s)=>t+n+r+o+s+(e/2**32|0)|0;var un=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),F=new Uint32Array(64),Tt=class extends ct{constructor(t){super(64,t,8,!1)}get(){let{A:t,B:n,C:r,D:o,E:s,F:c,G:f,H:i}=this;return[t,n,r,o,s,c,f,i]}set(t,n,r,o,s,c,f,i){this.A=t|0,this.B=n|0,this.C=r|0,this.D=o|0,this.E=s|0,this.F=c|0,this.G=f|0,this.H=i|0}process(t,n){for(let a=0;a<16;a++,n+=4)F[a]=t.getUint32(n,!1);for(let a=16;a<64;a++){let x=F[a-15],m=F[a-2],b=V(x,7)^V(x,18)^x>>>3,g=V(m,17)^V(m,19)^m>>>10;F[a]=g+F[a-7]+b+F[a-16]|0}let{A:r,B:o,C:s,D:c,E:f,F:i,G:u,H:h}=this;for(let a=0;a<64;a++){let x=V(f,6)^V(f,11)^V(f,25),m=h+x+re(f,i,u)+un[a]+F[a]|0,g=(V(r,2)^V(r,13)^V(r,22))+oe(r,o,s)|0;h=u,u=i,i=f,f=c+m|0,c=s,s=o,o=r,r=m+g|0}r=r+this.A|0,o=o+this.B|0,s=s+this.C|0,c=c+this.D|0,f=f+this.E|0,i=i+this.F|0,u=u+this.G|0,h=h+this.H|0,this.set(r,o,s,c,f,i,u,h)}roundClean(){M(F)}destroy(){this.set(0,0,0,0,0,0,0,0),M(this.buffer)}},Dt=class extends Tt{A=K[0]|0;B=K[1]|0;C=K[2]|0;D=K[3]|0;E=K[4]|0;F=K[5]|0;G=K[6]|0;H=K[7]|0;constructor(){super(32)}};var he=ie(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),dn=he[0],ln=he[1],$=new Uint32Array(80),z=new Uint32Array(80),Nt=class extends ct{constructor(t){super(128,t,16,!1)}get(){let{Ah:t,Al:n,Bh:r,Bl:o,Ch:s,Cl:c,Dh:f,Dl:i,Eh:u,El:h,Fh:a,Fl:x,Gh:m,Gl:b,Hh:g,Hl:y}=this;return[t,n,r,o,s,c,f,i,u,h,a,x,m,b,g,y]}set(t,n,r,o,s,c,f,i,u,h,a,x,m,b,g,y){this.Ah=t|0,this.Al=n|0,this.Bh=r|0,this.Bl=o|0,this.Ch=s|0,this.Cl=c|0,this.Dh=f|0,this.Dl=i|0,this.Eh=u|0,this.El=h|0,this.Fh=a|0,this.Fl=x|0,this.Gh=m|0,this.Gl=b|0,this.Hh=g|0,this.Hl=y|0}process(t,n){for(let l=0;l<16;l++,n+=4)$[l]=t.getUint32(n),z[l]=t.getUint32(n+=4);for(let l=16;l<80;l++){let w=$[l-15]|0,B=z[l-15]|0,A=J(w,B,1)^J(w,B,8)^Ht(w,B,7),I=tt(w,B,1)^tt(w,B,8)^Ot(w,B,7),E=$[l-2]|0,_=z[l-2]|0,R=J(E,_,19)^ft(E,_,61)^Ht(E,_,6),O=tt(E,_,19)^at(E,_,61)^Ot(E,_,6),D=ae(I,O,z[l-7],z[l-16]),U=ue(D,A,R,$[l-7],$[l-16]);$[l]=U|0,z[l]=D|0}let{Ah:r,Al:o,Bh:s,Bl:c,Ch:f,Cl:i,Dh:u,Dl:h,Eh:a,El:x,Fh:m,Fl:b,Gh:g,Gl:y,Hh:d,Hl:p}=this;for(let l=0;l<80;l++){let w=J(a,x,14)^J(a,x,18)^ft(a,x,41),B=tt(a,x,14)^tt(a,x,18)^at(a,x,41),A=a&m^~a&g,I=x&b^~x&y,E=de(p,B,I,ln[l],z[l]),_=le(E,d,w,A,dn[l],$[l]),R=E|0,O=J(r,o,28)^ft(r,o,34)^ft(r,o,39),D=tt(r,o,28)^at(r,o,34)^at(r,o,39),U=r&s^r&f^s&f,N=o&c^o&i^c&i;d=g|0,p=y|0,g=m|0,y=b|0,m=a|0,b=x|0,{h:a,l:x}=G(u|0,h|0,_|0,R|0),u=f|0,h=i|0,f=s|0,i=c|0,s=r|0,c=o|0;let C=ce(R,D,N);r=fe(C,_,O,U),o=C|0}({h:r,l:o}=G(this.Ah|0,this.Al|0,r|0,o|0)),{h:s,l:c}=G(this.Bh|0,this.Bl|0,s|0,c|0),{h:f,l:i}=G(this.Ch|0,this.Cl|0,f|0,i|0),{h:u,l:h}=G(this.Dh|0,this.Dl|0,u|0,h|0),{h:a,l:x}=G(this.Eh|0,this.El|0,a|0,x|0),{h:m,l:b}=G(this.Fh|0,this.Fl|0,m|0,b|0),{h:g,l:y}=G(this.Gh|0,this.Gl|0,g|0,y|0),{h:d,l:p}=G(this.Hh|0,this.Hl|0,d|0,p|0),this.set(r,o,s,c,f,i,u,h,a,x,m,b,g,y,d,p)}roundClean(){M($,z)}destroy(){M(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},qt=class extends Nt{Ah=L[0]|0;Al=L[1]|0;Bh=L[2]|0;Bl=L[3]|0;Ch=L[4]|0;Cl=L[5]|0;Dh=L[6]|0;Dl=L[7]|0;Eh=L[8]|0;El=L[9]|0;Fh=L[10]|0;Fl=L[11]|0;Gh=L[12]|0;Gl=L[13]|0;Hh=L[14]|0;Hl=L[15]|0;constructor(){super(64)}};var xe=Lt(()=>new Dt,Rt(1));var be=Lt(()=>new qt,Rt(3));var me=BigInt(0),pe=BigInt(1);function ge(e,t=""){if(typeof e!="boolean"){let n=t&&`"${t}" `;throw new Error(n+"expected boolean, got type="+typeof e)}return e}function xn(e){if(typeof e=="bigint"){if(!bt(e))throw new Error("positive bigint expected, got "+e)}else Z(e);return e}function ye(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?me:BigInt("0x"+e)}function we(e){return ye(j(e))}function st(e){return ye(j(pt(v(e)).reverse()))}function Zt(e,t){Z(t),e=xn(e);let n=X(e.toString(16).padStart(t*2,"0"));if(n.length!==t)throw new Error("number too large");return n}function Ee(e,t){return Zt(e,t).reverse()}function Be(e,t){if(e.length!==t.length)return!1;let n=0;for(let r=0;r<e.length;r++)n|=e[r]^t[r];return n===0}function pt(e){return Uint8Array.from(e)}var bt=e=>typeof e=="bigint"&&me<=e;function bn(e,t,n){return bt(e)&&bt(t)&&bt(n)&&t<=e&&e<n}function Ct(e,t,n,r){if(!bn(t,n,r))throw new Error("expected valid "+e+": "+n+" <= n < "+r+", got "+t)}var _e=e=>(pe<<BigInt(e))-pe;function mt(e,t={},n={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function r(s,c,f){let i=e[s];if(f&&i===void 0)return;let u=typeof i;if(u!==c||i===null)throw new Error(`param "${s}" is invalid: expected ${c}, got ${u}`)}let o=(s,c)=>Object.entries(s).forEach(([f,i])=>r(f,i,c));o(t,!1),o(n,!0)}var Mt=()=>{throw new Error("not implemented")};function Vt(e){let t=new WeakMap;return(n,...r)=>{let o=t.get(n);if(o!==void 0)return o;let s=e(n,...r);return t.set(n,s),s}}var T=BigInt(0),H=BigInt(1),et=BigInt(2),Ie=BigInt(3),ve=BigInt(4),Le=BigInt(5),pn=BigInt(7),Re=BigInt(8),mn=BigInt(9),He=BigInt(16);function S(e,t){let n=e%t;return n>=T?n:t+n}function k(e,t,n){let r=e;for(;t-- >T;)r*=r,r%=n;return r}function Se(e,t){if(e===T)throw new Error("invert: expected non-zero number");if(t<=T)throw new Error("invert: expected positive modulus, got "+t);let n=S(e,t),r=t,o=T,s=H,c=H,f=T;for(;n!==T;){let u=r/n,h=r%n,a=o-c*u,x=s-f*u;r=n,n=h,o=c,s=f,c=a,f=x}if(r!==H)throw new Error("invert: does not exist");return S(o,t)}function Gt(e,t,n){if(!e.eql(e.sqr(t),n))throw new Error("Cannot find square root")}function Oe(e,t){let n=(e.ORDER+H)/ve,r=e.pow(t,n);return Gt(e,r,t),r}function gn(e,t){let n=(e.ORDER-Le)/Re,r=e.mul(t,et),o=e.pow(r,n),s=e.mul(t,o),c=e.mul(e.mul(s,et),o),f=e.mul(s,e.sub(c,e.ONE));return Gt(e,f,t),f}function yn(e){let t=yt(e),n=Te(e),r=n(t,t.neg(t.ONE)),o=n(t,r),s=n(t,t.neg(r)),c=(e+pn)/He;return(f,i)=>{let u=f.pow(i,c),h=f.mul(u,r),a=f.mul(u,o),x=f.mul(u,s),m=f.eql(f.sqr(h),i),b=f.eql(f.sqr(a),i);u=f.cmov(u,h,m),h=f.cmov(x,a,b);let g=f.eql(f.sqr(h),i),y=f.cmov(u,h,g);return Gt(f,y,i),y}}function Te(e){if(e<Ie)throw new Error("sqrt is not defined for small field");let t=e-H,n=0;for(;t%et===T;)t/=et,n++;let r=et,o=yt(e);for(;Ae(o,r)===1;)if(r++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(n===1)return Oe;let s=o.pow(r,t),c=(t+H)/et;return function(i,u){if(i.is0(u))return u;if(Ae(i,u)!==1)throw new Error("Cannot find square root");let h=n,a=i.mul(i.ONE,s),x=i.pow(u,t),m=i.pow(u,c);for(;!i.eql(x,i.ONE);){if(i.is0(x))return i.ZERO;let b=1,g=i.sqr(x);for(;!i.eql(g,i.ONE);)if(b++,g=i.sqr(g),b===h)throw new Error("Cannot find square root");let y=H<<BigInt(h-b-1),d=i.pow(a,y);h=b,a=i.sqr(d),x=i.mul(x,a),m=i.mul(m,d)}return m}}function wn(e){return e%ve===Ie?Oe:e%Re===Le?gn:e%He===mn?yn(e):Te(e)}var W=(e,t)=>(S(e,t)&H)===H,En=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function De(e){let t={ORDER:"bigint",BYTES:"number",BITS:"number"},n=En.reduce((r,o)=>(r[o]="function",r),t);return mt(e,n),e}function Bn(e,t,n){if(n<T)throw new Error("invalid exponent, negatives unsupported");if(n===T)return e.ONE;if(n===H)return t;let r=e.ONE,o=t;for(;n>T;)n&H&&(r=e.mul(r,o)),o=e.sqr(o),n>>=H;return r}function gt(e,t,n=!1){let r=new Array(t.length).fill(n?e.ZERO:void 0),o=t.reduce((c,f,i)=>e.is0(f)?c:(r[i]=c,e.mul(c,f)),e.ONE),s=e.inv(o);return t.reduceRight((c,f,i)=>e.is0(f)?c:(r[i]=e.mul(c,r[i]),e.mul(c,f)),s),r}function Ae(e,t){let n=(e.ORDER-H)/et,r=e.pow(t,n),o=e.eql(r,e.ONE),s=e.eql(r,e.ZERO),c=e.eql(r,e.neg(e.ONE));if(!o&&!s&&!c)throw new Error("invalid Legendre symbol result");return o?1:s?0:-1}function _n(e,t){t!==void 0&&Z(t);let n=t!==void 0?t:e.toString(2).length,r=Math.ceil(n/8);return{nBitLength:n,nByteLength:r}}var kt=class{ORDER;BITS;BYTES;isLE;ZERO=T;ONE=H;_lengths;_sqrt;_mod;constructor(t,n={}){if(t<=T)throw new Error("invalid field: expected ORDER > 0, got "+t);let r;this.isLE=!1,n!=null&&typeof n=="object"&&(typeof n.BITS=="number"&&(r=n.BITS),typeof n.sqrt=="function"&&(this.sqrt=n.sqrt),typeof n.isLE=="boolean"&&(this.isLE=n.isLE),n.allowedLengths&&(this._lengths=n.allowedLengths?.slice()),typeof n.modFromBytes=="boolean"&&(this._mod=n.modFromBytes));let{nBitLength:o,nByteLength:s}=_n(t,r);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=t,this.BITS=o,this.BYTES=s,this._sqrt=void 0,Object.preventExtensions(this)}create(t){return S(t,this.ORDER)}isValid(t){if(typeof t!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof t);return T<=t&&t<this.ORDER}is0(t){return t===T}isValidNot0(t){return!this.is0(t)&&this.isValid(t)}isOdd(t){return(t&H)===H}neg(t){return S(-t,this.ORDER)}eql(t,n){return t===n}sqr(t){return S(t*t,this.ORDER)}add(t,n){return S(t+n,this.ORDER)}sub(t,n){return S(t-n,this.ORDER)}mul(t,n){return S(t*n,this.ORDER)}pow(t,n){return Bn(this,t,n)}div(t,n){return S(t*Se(n,this.ORDER),this.ORDER)}sqrN(t){return t*t}addN(t,n){return t+n}subN(t,n){return t-n}mulN(t,n){return t*n}inv(t){return Se(t,this.ORDER)}sqrt(t){return this._sqrt||(this._sqrt=wn(this.ORDER)),this._sqrt(this,t)}toBytes(t){return this.isLE?Ee(t,this.BYTES):Zt(t,this.BYTES)}fromBytes(t,n=!1){v(t);let{_lengths:r,BYTES:o,isLE:s,ORDER:c,_mod:f}=this;if(r){if(!r.includes(t.length)||t.length>o)throw new Error("Field.fromBytes: expected "+r+" bytes, got "+t.length);let u=new Uint8Array(o);u.set(t,s?0:u.length-t.length),t=u}if(t.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+t.length);let i=s?st(t):we(t);if(f&&(i=S(i,c)),!n&&!this.isValid(i))throw new Error("invalid field element: outside of range 0..ORDER");return i}invertBatch(t){return gt(this,t)}cmov(t,n,r){return r?n:t}};function yt(e,t={}){return new kt(e,t)}var wt=BigInt(0),Kt=BigInt(1);function Ne(e,t){let n=t.negate();return e?n:t}function Bt(e,t){let n=gt(e.Fp,t.map(r=>r.Z));return t.map((r,o)=>e.fromAffine(r.toAffine(n[o])))}function Ce(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function Yt(e,t){Ce(e,t);let n=Math.ceil(t/e)+1,r=2**(e-1),o=2**e,s=_e(e),c=BigInt(e);return{windows:n,windowSize:r,mask:s,maxNumber:o,shiftBy:c}}function qe(e,t,n){let{windowSize:r,mask:o,maxNumber:s,shiftBy:c}=n,f=Number(e&o),i=e>>c;f>r&&(f-=s,i+=Kt);let u=t*r,h=u+Math.abs(f)-1,a=f===0,x=f<0,m=t%2!==0;return{nextN:i,offset:h,isZero:a,isNeg:x,isNegF:m,offsetF:u}}var jt=new WeakMap,Me=new WeakMap;function Xt(e){return Me.get(e)||1}function Ue(e){if(e!==wt)throw new Error("invalid wNAF")}var Et=class{BASE;ZERO;Fn;bits;constructor(t,n){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=n}_unsafeLadder(t,n,r=this.ZERO){let o=t;for(;n>wt;)n&Kt&&(r=r.add(o)),o=o.double(),n>>=Kt;return r}precomputeWindow(t,n){let{windows:r,windowSize:o}=Yt(n,this.bits),s=[],c=t,f=c;for(let i=0;i<r;i++){f=c,s.push(f);for(let u=1;u<o;u++)f=f.add(c),s.push(f);c=f.double()}return s}wNAF(t,n,r){if(!this.Fn.isValid(r))throw new Error("invalid scalar");let o=this.ZERO,s=this.BASE,c=Yt(t,this.bits);for(let f=0;f<c.windows;f++){let{nextN:i,offset:u,isZero:h,isNeg:a,isNegF:x,offsetF:m}=qe(r,f,c);r=i,h?s=s.add(Ne(x,n[m])):o=o.add(Ne(a,n[u]))}return Ue(r),{p:o,f:s}}wNAFUnsafe(t,n,r,o=this.ZERO){let s=Yt(t,this.bits);for(let c=0;c<s.windows&&r!==wt;c++){let{nextN:f,offset:i,isZero:u,isNeg:h}=qe(r,c,s);if(r=f,!u){let a=n[i];o=o.add(h?a.negate():a)}}return Ue(r),o}getPrecomputes(t,n,r){let o=jt.get(n);return o||(o=this.precomputeWindow(n,t),t!==1&&(typeof r=="function"&&(o=r(o)),jt.set(n,o))),o}cached(t,n,r){let o=Xt(t);return this.wNAF(o,this.getPrecomputes(o,t,r),n)}unsafe(t,n,r,o){let s=Xt(t);return s===1?this._unsafeLadder(t,n,o):this.wNAFUnsafe(s,this.getPrecomputes(s,t,r),n,o)}createCache(t,n){Ce(n,this.bits),Me.set(t,n),jt.delete(t)}hasCache(t){return Xt(t)!==1}};function Ze(e,t,n){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return De(t),t}else return yt(e,{isLE:n})}function Ve(e,t,n={},r){if(r===void 0&&(r=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(let i of["p","n","h"]){let u=t[i];if(!(typeof u=="bigint"&&u>wt))throw new Error(`CURVE.${i} must be positive bigint`)}let o=Ze(t.p,n.Fp,r),s=Ze(t.n,n.Fn,r),f=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(let i of f)if(!o.isValid(t[i]))throw new Error(`CURVE.${i} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:s}}var Q=BigInt(0),q=BigInt(1),Ft=BigInt(2),Sn=BigInt(8);function An(e,t,n,r){let o=e.sqr(n),s=e.sqr(r),c=e.add(e.mul(t.a,o),s),f=e.add(e.ONE,e.mul(t.d,e.mul(o,s)));return e.eql(c,f)}function ke(e,t={}){let n=Ve("edwards",e,t,t.FpFnLE),{Fp:r,Fn:o}=n,s=n.CURVE,{h:c}=s;mt(t,{},{uvRatio:"function"});let f=Ft<<BigInt(o.BYTES*8)-q,i=y=>r.create(y),u=t.uvRatio||((y,d)=>{try{return{isValid:!0,value:r.sqrt(r.div(y,d))}}catch{return{isValid:!1,value:Q}}});if(!An(r,s,s.Gx,s.Gy))throw new Error("bad curve params: generator point");function h(y,d,p=!1){let l=p?q:Q;return Ct("coordinate "+y,d,l,f),d}function a(y){if(!(y instanceof b))throw new Error("EdwardsPoint expected")}let x=Vt((y,d)=>{let{X:p,Y:l,Z:w}=y,B=y.is0();d==null&&(d=B?Sn:r.inv(w));let A=i(p*d),I=i(l*d),E=r.mul(w,d);if(B)return{x:Q,y:q};if(E!==q)throw new Error("invZ was invalid");return{x:A,y:I}}),m=Vt(y=>{let{a:d,d:p}=s;if(y.is0())throw new Error("bad point: ZERO");let{X:l,Y:w,Z:B,T:A}=y,I=i(l*l),E=i(w*w),_=i(B*B),R=i(_*_),O=i(I*d),D=i(_*i(O+E)),U=i(R+i(p*i(I*E)));if(D!==U)throw new Error("bad point: equation left != right (1)");let N=i(l*w),C=i(B*A);if(N!==C)throw new Error("bad point: equation left != right (2)");return!0});class b{static BASE=new b(s.Gx,s.Gy,q,i(s.Gx*s.Gy));static ZERO=new b(Q,q,q,Q);static Fp=r;static Fn=o;X;Y;Z;T;constructor(d,p,l,w){this.X=h("x",d),this.Y=h("y",p),this.Z=h("z",l,!0),this.T=h("t",w),Object.freeze(this)}static CURVE(){return s}static fromAffine(d){if(d instanceof b)throw new Error("extended point not allowed");let{x:p,y:l}=d||{};return h("x",p),h("y",l),new b(p,l,q,i(p*l))}static fromBytes(d,p=!1){let l=r.BYTES,{a:w,d:B}=s;d=pt(v(d,l,"point")),ge(p,"zip215");let A=pt(d),I=d[l-1];A[l-1]=I&-129;let E=st(A),_=p?f:r.ORDER;Ct("point.y",E,Q,_);let R=i(E*E),O=i(R-q),D=i(B*R-w),{isValid:U,value:N}=u(O,D);if(!U)throw new Error("bad point: invalid y coordinate");let C=(N&q)===q,P=(I&128)!==0;if(!p&&N===Q&&P)throw new Error("bad point: x=0 and x_0=1");return P!==C&&(N=i(-N)),b.fromAffine({x:N,y:E})}static fromHex(d,p=!1){return b.fromBytes(X(d),p)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(d=8,p=!0){return g.createCache(this,d),p||this.multiply(Ft),this}assertValidity(){m(this)}equals(d){a(d);let{X:p,Y:l,Z:w}=this,{X:B,Y:A,Z:I}=d,E=i(p*I),_=i(B*w),R=i(l*I),O=i(A*w);return E===_&&R===O}is0(){return this.equals(b.ZERO)}negate(){return new b(i(-this.X),this.Y,this.Z,i(-this.T))}double(){let{a:d}=s,{X:p,Y:l,Z:w}=this,B=i(p*p),A=i(l*l),I=i(Ft*i(w*w)),E=i(d*B),_=p+l,R=i(i(_*_)-B-A),O=E+A,D=O-I,U=E-A,N=i(R*D),C=i(O*U),P=i(R*U),lt=i(D*O);return new b(N,C,lt,P)}add(d){a(d);let{a:p,d:l}=s,{X:w,Y:B,Z:A,T:I}=this,{X:E,Y:_,Z:R,T:O}=d,D=i(w*E),U=i(B*_),N=i(I*l*O),C=i(A*R),P=i((w+B)*(E+_)-D-U),lt=C-N,Qt=C+N,Pt=i(U-p*D),ze=i(P*lt),We=i(Qt*Pt),Qe=i(P*Pt),Pe=i(lt*Qt);return new b(ze,We,Pe,Qe)}subtract(d){return this.add(d.negate())}multiply(d){if(!o.isValidNot0(d))throw new Error("invalid scalar: expected 1 <= sc < curve.n");let{p,f:l}=g.cached(this,d,w=>Bt(b,w));return Bt(b,[p,l])[0]}multiplyUnsafe(d,p=b.ZERO){if(!o.isValid(d))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return d===Q?b.ZERO:this.is0()||d===q?this:g.unsafe(this,d,l=>Bt(b,l),p)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return g.unsafe(this,s.n).is0()}toAffine(d){return x(this,d)}clearCofactor(){return c===q?this:this.multiplyUnsafe(c)}toBytes(){let{x:d,y:p}=this.toAffine(),l=r.toBytes(p);return l[l.length-1]|=d&q?128:0,l}toHex(){return j(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}let g=new Et(b,o.BITS);return b.BASE.precompute(8),b}var _t=class{static BASE;static ZERO;static Fp;static Fn;ep;constructor(t){this.ep=t}static fromBytes(t){Mt()}static fromHex(t){Mt()}get x(){return this.toAffine().x}get y(){return this.toAffine().y}clearCofactor(){return this}assertValidity(){this.ep.assertValidity()}toAffine(t){return this.ep.toAffine(t)}toHex(){return j(this.toBytes())}toString(){return this.toHex()}isTorsionFree(){return!0}isSmallOrder(){return!1}add(t){return this.assertSame(t),this.init(this.ep.add(t.ep))}subtract(t){return this.assertSame(t),this.init(this.ep.subtract(t.ep))}multiply(t){return this.init(this.ep.multiply(t))}multiplyUnsafe(t){return this.init(this.ep.multiplyUnsafe(t))}double(){return this.init(this.ep.double())}negate(){return this.init(this.ep.negate())}precompute(t,n){return this.init(this.ep.precompute(t,n))}};var In=BigInt(0),ut=BigInt(1),Ge=BigInt(2);var vn=BigInt(5),Ln=BigInt(8),dt=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),Xe={p:dt,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Ln,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Rn(e){let t=BigInt(10),n=BigInt(20),r=BigInt(40),o=BigInt(80),s=dt,f=e*e%s*e%s,i=k(f,Ge,s)*f%s,u=k(i,ut,s)*e%s,h=k(u,vn,s)*u%s,a=k(h,t,s)*h%s,x=k(a,n,s)*a%s,m=k(x,r,s)*x%s,b=k(m,o,s)*m%s,g=k(b,o,s)*m%s,y=k(g,t,s)*h%s;return{pow_p_5_8:k(y,Ge,s)*e%s,b2:f}}var $t=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function Ke(e,t){let n=dt,r=S(t*t*t,n),o=S(r*r*t,n),s=Rn(e*o).pow_p_5_8,c=S(e*r*s,n),f=S(t*c*c,n),i=c,u=S(c*$t,n),h=f===e,a=f===S(-e,n),x=f===S(-e*$t,n);return h&&(c=i),(a||x)&&(c=u),W(c,n)&&(c=S(-c,n)),{isValid:h||a,value:c}}var it=ke(Xe,{uvRatio:Ke}),nt=it.Fp,Hn=it.Fn;var Ye=$t;var On=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578");var je=e=>Ke(ut,e),Tn=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),Dn=e=>nt.create(st(e)&Tn);var zt=class e extends _t{static BASE=new e(it.BASE);static ZERO=new e(it.ZERO);static Fp=nt;static Fn=Hn;constructor(t){super(t)}static fromAffine(t){return new e(it.fromAffine(t))}assertSame(t){if(!(t instanceof e))throw new Error("RistrettoPoint expected")}init(t){return new e(t)}static fromBytes(t){v(t,32);let{a:n,d:r}=Xe,o=dt,s=w=>nt.create(w),c=Dn(t);if(!Be(nt.toBytes(c),t)||W(c,o))throw new Error("invalid ristretto255 encoding 1");let f=s(c*c),i=s(ut+n*f),u=s(ut-n*f),h=s(i*i),a=s(u*u),x=s(n*r*h-a),{isValid:m,value:b}=je(s(x*a)),g=s(b*u),y=s(b*g*x),d=s((c+c)*g);W(d,o)&&(d=s(-d));let p=s(i*y),l=s(d*p);if(!m||W(l,o)||p===In)throw new Error("invalid ristretto255 encoding 2");return new e(new it(d,p,ut,l))}static fromHex(t){return e.fromBytes(X(t))}toBytes(){let{X:t,Y:n,Z:r,T:o}=this.ep,s=dt,c=y=>nt.create(y),f=c(c(r+n)*c(r-n)),i=c(t*n),u=c(i*i),{value:h}=je(c(f*u)),a=c(h*f),x=c(h*i),m=c(a*x*o),b;if(W(o*m,s)){let y=c(n*Ye),d=c(t*Ye);t=y,n=d,b=c(a*On)}else b=x;W(t*m,s)&&(n=c(-n));let g=c((r-n)*b);return W(g,s)&&(g=c(-g)),nt.toBytes(g)}equals(t){this.assertSame(t);let{X:n,Y:r}=this.ep,{X:o,Y:s}=t.ep,c=u=>nt.create(u),f=c(n*s)===c(r*o),i=c(r*s)===c(n*o);return f||i}is0(){return this.equals(e.ZERO)}},Fe={Point:zt};var St=class{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,n){if(ht(t),v(n,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let r=this.blockLen,o=new Uint8Array(r);o.set(n.length>r?t.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=t.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),M(o)}update(t){return rt(this),this.iHash.update(t),this}digestInto(t){rt(this),v(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});let{oHash:n,iHash:r,finished:o,destroyed:s,blockLen:c,outputLen:f}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=c,t.outputLen=f,t.oHash=n._cloneInto(t.oHash),t.iHash=r._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Wt=(e,t,n)=>new St(e,t).update(n).digest();Wt.create=(e,t)=>new St(e,t);function Nn(e,t,n,r){ht(e);let o=ne({dkLen:32,asyncTick:10},r),{c:s,dkLen:c,asyncTick:f}=o;if(Z(s,"c"),Z(c,"dkLen"),Z(f,"asyncTick"),s<1)throw new Error("iterations (c) must be >= 1");let i=vt(t,"password"),u=vt(n,"salt"),h=new Uint8Array(c),a=Wt.create(e,i),x=a._cloneInto().update(u);return{c:s,dkLen:c,asyncTick:f,DK:h,PRF:a,PRFSalt:x}}function qn(e,t,n,r,o){return e.destroy(),t.destroy(),r&&r.destroy(),M(o),n}function $e(e,t,n,r){let{c:o,dkLen:s,DK:c,PRF:f,PRFSalt:i}=Nn(e,t,n,r),u,h=new Uint8Array(4),a=ot(h),x=new Uint8Array(f.outputLen);for(let m=1,b=0;b<s;m++,b+=f.outputLen){let g=c.subarray(b,b+f.outputLen);a.setInt32(0,m,!1),(u=i._cloneInto(u)).update(h).digestInto(x),g.set(x.subarray(0,g.length));for(let y=1;y<o;y++){f._cloneInto(u).update(x).digestInto(x);for(let d=0;d<g.length;d++)g[d]^=x[d]}}return qn(f,i,c,u,x)}return on(Un);})();</script>

<script>
var WORDLIST = "abandon,ability,able,about,above,absent,absorb,abstract,absurd,abuse,access,accident,account,accuse,achieve,acid,acoustic,acquire,across,act,action,actor,actress,actual,adapt,add,addict,address,adjust,admit,adult,advance,advice,aerobic,affair,afford,afraid,again,age,agent,agree,ahead,aim,air,airport,aisle,alarm,album,alcohol,alert,alien,all,alley,allow,almost,alone,alpha,already,also,alter,always,amateur,amazing,among,amount,amused,analyst,anchor,ancient,anger,angle,angry,animal,ankle,announce,annual,another,answer,antenna,antique,anxiety,any,apart,apology,appear,apple,approve,april,arch,arctic,area,arena,argue,arm,armed,armor,army,around,arrange,arrest,arrive,arrow,art,artefact,artist,artwork,ask,aspect,assault,asset,assist,assume,asthma,athlete,atom,attack,attend,attitude,attract,auction,audit,august,aunt,author,auto,autumn,average,avocado,avoid,awake,aware,away,awesome,awful,awkward,axis,baby,bachelor,bacon,badge,bag,balance,balcony,ball,bamboo,banana,banner,bar,barely,bargain,barrel,base,basic,basket,battle,beach,bean,beauty,because,become,beef,before,begin,behave,behind,believe,below,belt,bench,benefit,best,betray,better,between,beyond,bicycle,bid,bike,bind,biology,bird,birth,bitter,black,blade,blame,blanket,blast,bleak,bless,blind,blood,blossom,blouse,blue,blur,blush,board,boat,body,boil,bomb,bone,bonus,book,boost,border,boring,borrow,boss,bottom,bounce,box,boy,bracket,brain,brand,brass,brave,bread,breeze,brick,bridge,brief,bright,bring,brisk,broccoli,broken,bronze,broom,brother,brown,brush,bubble,buddy,budget,buffalo,build,bulb,bulk,bullet,bundle,bunker,burden,burger,burst,bus,business,busy,butter,buyer,buzz,cabbage,cabin,cable,cactus,cage,cake,call,calm,camera,camp,can,canal,cancel,candy,cannon,canoe,canvas,canyon,capable,capital,captain,car,carbon,card,cargo,carpet,carry,cart,case,cash,casino,castle,casual,cat,catalog,catch,category,cattle,caught,cause,caution,cave,ceiling,celery,cement,census,century,cereal,certain,chair,chalk,champion,change,chaos,chapter,charge,chase,chat,cheap,check,cheese,chef,cherry,chest,chicken,chief,child,chimney,choice,choose,chronic,chuckle,chunk,churn,cigar,cinnamon,circle,citizen,city,civil,claim,clap,clarify,claw,clay,clean,clerk,clever,click,client,cliff,climb,clinic,clip,clock,clog,close,cloth,cloud,clown,club,clump,cluster,clutch,coach,coast,coconut,code,coffee,coil,coin,collect,color,column,combine,come,comfort,comic,common,company,concert,conduct,confirm,congress,connect,consider,control,convince,cook,cool,copper,copy,coral,core,corn,correct,cost,cotton,couch,country,couple,course,cousin,cover,coyote,crack,cradle,craft,cram,crane,crash,crater,crawl,crazy,cream,credit,creek,crew,cricket,crime,crisp,critic,crop,cross,crouch,crowd,crucial,cruel,cruise,crumble,crunch,crush,cry,crystal,cube,culture,cup,cupboard,curious,current,curtain,curve,cushion,custom,cute,cycle,dad,damage,damp,dance,danger,daring,dash,daughter,dawn,day,deal,debate,debris,decade,december,decide,decline,decorate,decrease,deer,defense,define,defy,degree,delay,deliver,demand,demise,denial,dentist,deny,depart,depend,deposit,depth,deputy,derive,describe,desert,design,desk,despair,destroy,detail,detect,develop,device,devote,diagram,dial,diamond,diary,dice,diesel,diet,differ,digital,dignity,dilemma,dinner,dinosaur,direct,dirt,disagree,discover,disease,dish,dismiss,disorder,display,distance,divert,divide,divorce,dizzy,doctor,document,dog,doll,dolphin,domain,donate,donkey,donor,door,dose,double,dove,draft,dragon,drama,drastic,draw,dream,dress,drift,drill,drink,drip,drive,drop,drum,dry,duck,dumb,dune,during,dust,dutch,duty,dwarf,dynamic,eager,eagle,early,earn,earth,easily,east,easy,echo,ecology,economy,edge,edit,educate,effort,egg,eight,either,elbow,elder,electric,elegant,element,elephant,elevator,elite,else,embark,embody,embrace,emerge,emotion,employ,empower,empty,enable,enact,end,endless,endorse,enemy,energy,enforce,engage,engine,enhance,enjoy,enlist,enough,enrich,enroll,ensure,enter,entire,entry,envelope,episode,equal,equip,era,erase,erode,erosion,error,erupt,escape,essay,essence,estate,eternal,ethics,evidence,evil,evoke,evolve,exact,example,excess,exchange,excite,exclude,excuse,execute,exercise,exhaust,exhibit,exile,exist,exit,exotic,expand,expect,expire,explain,expose,express,extend,extra,eye,eyebrow,fabric,face,faculty,fade,faint,faith,fall,false,fame,family,famous,fan,fancy,fantasy,farm,fashion,fat,fatal,father,fatigue,fault,favorite,feature,february,federal,fee,feed,feel,female,fence,festival,fetch,fever,few,fiber,fiction,field,figure,file,film,filter,final,find,fine,finger,finish,fire,firm,first,fiscal,fish,fit,fitness,fix,flag,flame,flash,flat,flavor,flee,flight,flip,float,flock,floor,flower,fluid,flush,fly,foam,focus,fog,foil,fold,follow,food,foot,force,forest,forget,fork,fortune,forum,forward,fossil,foster,found,fox,fragile,frame,frequent,fresh,friend,fringe,frog,front,frost,frown,frozen,fruit,fuel,fun,funny,furnace,fury,future,gadget,gain,galaxy,gallery,game,gap,garage,garbage,garden,garlic,garment,gas,gasp,gate,gather,gauge,gaze,general,genius,genre,gentle,genuine,gesture,ghost,giant,gift,giggle,ginger,giraffe,girl,give,glad,glance,glare,glass,glide,glimpse,globe,gloom,glory,glove,glow,glue,goat,goddess,gold,good,goose,gorilla,gospel,gossip,govern,gown,grab,grace,grain,grant,grape,grass,gravity,great,green,grid,grief,grit,grocery,group,grow,grunt,guard,guess,guide,guilt,guitar,gun,gym,habit,hair,half,hammer,hamster,hand,happy,harbor,hard,harsh,harvest,hat,have,hawk,hazard,head,health,heart,heavy,hedgehog,height,hello,helmet,help,hen,hero,hidden,high,hill,hint,hip,hire,history,hobby,hockey,hold,hole,holiday,hollow,home,honey,hood,hope,horn,horror,horse,hospital,host,hotel,hour,hover,hub,huge,human,humble,humor,hundred,hungry,hunt,hurdle,hurry,hurt,husband,hybrid,ice,icon,idea,identify,idle,ignore,ill,illegal,illness,image,imitate,immense,immune,impact,impose,improve,impulse,inch,include,income,increase,index,indicate,indoor,industry,infant,inflict,inform,inhale,inherit,initial,inject,injury,inmate,inner,innocent,input,inquiry,insane,insect,inside,inspire,install,intact,interest,into,invest,invite,involve,iron,island,isolate,issue,item,ivory,jacket,jaguar,jar,jazz,jealous,jeans,jelly,jewel,job,join,joke,journey,joy,judge,juice,jump,jungle,junior,junk,just,kangaroo,keen,keep,ketchup,key,kick,kid,kidney,kind,kingdom,kiss,kit,kitchen,kite,kitten,kiwi,knee,knife,knock,know,lab,label,labor,ladder,lady,lake,lamp,language,laptop,large,later,latin,laugh,laundry,lava,law,lawn,lawsuit,layer,lazy,leader,leaf,learn,leave,lecture,left,leg,legal,legend,leisure,lemon,lend,length,lens,leopard,lesson,letter,level,liar,liberty,library,license,life,lift,light,like,limb,limit,link,lion,liquid,list,little,live,lizard,load,loan,lobster,local,lock,logic,lonely,long,loop,lottery,loud,lounge,love,loyal,lucky,luggage,lumber,lunar,lunch,luxury,lyrics,machine,mad,magic,magnet,maid,mail,main,major,make,mammal,man,manage,mandate,mango,mansion,manual,maple,marble,march,margin,marine,market,marriage,mask,mass,master,match,material,math,matrix,matter,maximum,maze,meadow,mean,measure,meat,mechanic,medal,media,melody,melt,member,memory,mention,menu,mercy,merge,merit,merry,mesh,message,metal,method,middle,midnight,milk,million,mimic,mind,minimum,minor,minute,miracle,mirror,misery,miss,mistake,mix,mixed,mixture,mobile,model,modify,mom,moment,monitor,monkey,monster,month,moon,moral,more,morning,mosquito,mother,motion,motor,mountain,mouse,move,movie,much,muffin,mule,multiply,muscle,museum,mushroom,music,must,mutual,myself,mystery,myth,naive,name,napkin,narrow,nasty,nation,nature,near,neck,need,negative,neglect,neither,nephew,nerve,nest,net,network,neutral,never,news,next,nice,night,noble,noise,nominee,noodle,normal,north,nose,notable,note,nothing,notice,novel,now,nuclear,number,nurse,nut,oak,obey,object,oblige,obscure,observe,obtain,obvious,occur,ocean,october,odor,off,offer,office,often,oil,okay,old,olive,olympic,omit,once,one,onion,online,only,open,opera,opinion,oppose,option,orange,orbit,orchard,order,ordinary,organ,orient,original,orphan,ostrich,other,outdoor,outer,output,outside,oval,oven,over,own,owner,oxygen,oyster,ozone,pact,paddle,page,pair,palace,palm,panda,panel,panic,panther,paper,parade,parent,park,parrot,party,pass,patch,path,patient,patrol,pattern,pause,pave,payment,peace,peanut,pear,peasant,pelican,pen,penalty,pencil,people,pepper,perfect,permit,person,pet,phone,photo,phrase,physical,piano,picnic,picture,piece,pig,pigeon,pill,pilot,pink,pioneer,pipe,pistol,pitch,pizza,place,planet,plastic,plate,play,please,pledge,pluck,plug,plunge,poem,poet,point,polar,pole,police,pond,pony,pool,popular,portion,position,possible,post,potato,pottery,poverty,powder,power,practice,praise,predict,prefer,prepare,present,pretty,prevent,price,pride,primary,print,priority,prison,private,prize,problem,process,produce,profit,program,project,promote,proof,property,prosper,protect,proud,provide,public,pudding,pull,pulp,pulse,pumpkin,punch,pupil,puppy,purchase,purity,purpose,purse,push,put,puzzle,pyramid,quality,quantum,quarter,question,quick,quit,quiz,quote,rabbit,raccoon,race,rack,radar,radio,rail,rain,raise,rally,ramp,ranch,random,range,rapid,rare,rate,rather,raven,raw,razor,ready,real,reason,rebel,rebuild,recall,receive,recipe,record,recycle,reduce,reflect,reform,refuse,region,regret,regular,reject,relax,release,relief,rely,remain,remember,remind,remove,render,renew,rent,reopen,repair,repeat,replace,report,require,rescue,resemble,resist,resource,response,result,retire,retreat,return,reunion,reveal,review,reward,rhythm,rib,ribbon,rice,rich,ride,ridge,rifle,right,rigid,ring,riot,ripple,risk,ritual,rival,river,road,roast,robot,robust,rocket,romance,roof,rookie,room,rose,rotate,rough,round,route,royal,rubber,rude,rug,rule,run,runway,rural,sad,saddle,sadness,safe,sail,salad,salmon,salon,salt,salute,same,sample,sand,satisfy,satoshi,sauce,sausage,save,say,scale,scan,scare,scatter,scene,scheme,school,science,scissors,scorpion,scout,scrap,screen,script,scrub,sea,search,season,seat,second,secret,section,security,seed,seek,segment,select,sell,seminar,senior,sense,sentence,series,service,session,settle,setup,seven,shadow,shaft,shallow,share,shed,shell,sheriff,shield,shift,shine,ship,shiver,shock,shoe,shoot,shop,short,shoulder,shove,shrimp,shrug,shuffle,shy,sibling,sick,side,siege,sight,sign,silent,silk,silly,silver,similar,simple,since,sing,siren,sister,situate,six,size,skate,sketch,ski,skill,skin,skirt,skull,slab,slam,sleep,slender,slice,slide,slight,slim,slogan,slot,slow,slush,small,smart,smile,smoke,smooth,snack,snake,snap,sniff,snow,soap,soccer,social,sock,soda,soft,solar,soldier,solid,solution,solve,someone,song,soon,sorry,sort,soul,sound,soup,source,south,space,spare,spatial,spawn,speak,special,speed,spell,spend,sphere,spice,spider,spike,spin,spirit,split,spoil,sponsor,spoon,sport,spot,spray,spread,spring,spy,square,squeeze,squirrel,stable,stadium,staff,stage,stairs,stamp,stand,start,state,stay,steak,steel,stem,step,stereo,stick,still,sting,stock,stomach,stone,stool,story,stove,strategy,street,strike,strong,struggle,student,stuff,stumble,style,subject,submit,subway,success,such,sudden,suffer,sugar,suggest,suit,summer,sun,sunny,sunset,super,supply,supreme,sure,surface,surge,surprise,surround,survey,suspect,sustain,swallow,swamp,swap,swarm,swear,sweet,swift,swim,swing,switch,sword,symbol,symptom,syrup,system,table,tackle,tag,tail,talent,talk,tank,tape,target,task,taste,tattoo,taxi,teach,team,tell,ten,tenant,tennis,tent,term,test,text,thank,that,theme,then,theory,there,they,thing,this,thought,three,thrive,throw,thumb,thunder,ticket,tide,tiger,tilt,timber,time,tiny,tip,tired,tissue,title,toast,tobacco,today,toddler,toe,together,toilet,token,tomato,tomorrow,tone,tongue,tonight,tool,tooth,top,topic,topple,torch,tornado,tortoise,toss,total,tourist,toward,tower,town,toy,track,trade,traffic,tragic,train,transfer,trap,trash,travel,tray,treat,tree,trend,trial,tribe,trick,trigger,trim,trip,trophy,trouble,truck,true,truly,trumpet,trust,truth,try,tube,tuition,tumble,tuna,tunnel,turkey,turn,turtle,twelve,twenty,twice,twin,twist,two,type,typical,ugly,umbrella,unable,unaware,uncle,uncover,under,undo,unfair,unfold,unhappy,uniform,unique,unit,universe,unknown,unlock,until,unusual,unveil,update,upgrade,uphold,upon,upper,upset,urban,urge,usage,use,used,useful,useless,usual,utility,vacant,vacuum,vague,valid,valley,valve,van,vanish,vapor,various,vast,vault,vehicle,velvet,vendor,venture,venue,verb,verify,version,very,vessel,veteran,viable,vibrant,vicious,victory,video,view,village,vintage,violin,virtual,virus,visa,visit,visual,vital,vivid,vocal,voice,void,volcano,volume,vote,voyage,wage,wagon,wait,walk,wall,walnut,want,warfare,warm,warrior,wash,wasp,waste,water,wave,way,wealth,weapon,wear,weasel,weather,web,wedding,weekend,weird,welcome,west,wet,whale,what,wheat,wheel,when,where,whip,whisper,wide,width,wife,wild,will,win,window,wine,wing,wink,winner,winter,wire,wisdom,wise,wish,witness,wolf,woman,wonder,wood,wool,word,work,world,worry,worth,wrap,wreck,wrestle,wrist,write,wrong,yard,year,yellow,you,young,youth,zebra,zero,zone,zoo".split(",");

var P = noble.ristretto255.Point;
var L = 2n**252n + 27742317777372353535851937790883648493n;
var ALPHABET = "123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";

function base58Encode(bytes) {
  var num = 0n;
  for (var i = 0; i < bytes.length; i++) num = num * 256n + BigInt(bytes[i]);
  var str = "";
  while (num > 0n) { str = ALPHABET[Number(num % 58n)] + str; num /= 58n; }
  for (var j = 0; j < bytes.length; j++) { if (bytes[j] !== 0) break; str = "1" + str; }
  return str;
}

function blocknetKeygen(seed32) {
  var domain = new TextEncoder().encode("blocknet_keygen");
  var combined = new Uint8Array(domain.length + 32);
  combined.set(domain);
  combined.set(seed32, domain.length);
  var hash = noble.sha512(combined);
  var scalar = 0n;
  for (var i = 0; i < 64; i++) scalar += BigInt(hash[i]) << BigInt(8 * i);
  scalar = scalar % L;
  var pubEp = P.BASE.ep.multiply(scalar);
  var pubPoint = new P(pubEp);
  var pubBytes = pubPoint.toBytes();
  var privBytes = new Uint8Array(32);
  var s = scalar;
  for (var j = 0; j < 32; j++) { privBytes[j] = Number(s & 0xFFn); s >>= 8n; }
  return { privBytes: privBytes, pubBytes: pubBytes };
}

function generateMnemonic() {
  var entropy = new Uint8Array(16);
  crypto.getRandomValues(entropy);
  var hash = noble.sha256(entropy);
  var checksumByte = hash[0];
  var bits = [];
  for (var i = 0; i < 128; i++) bits.push((entropy[i >> 3] & (1 << (7 - (i % 8)))) !== 0 ? 1 : 0);
  for (var j = 0; j < 4; j++) bits.push((checksumByte & (1 << (7 - j))) !== 0 ? 1 : 0);
  var words = [];
  for (var k = 0; k < 12; k++) {
    var idx = 0;
    for (var b = 0; b < 11; b++) { if (bits[k * 11 + b]) idx |= 1 << (10 - b); }
    words.push(WORDLIST[idx]);
  }
  return words.join(" ");
}

function mnemonicToSeed(mnemonic) {
  var pw = new TextEncoder().encode(mnemonic.toLowerCase().trim());
  var salt = new TextEncoder().encode("mnemonic");
  return noble.pbkdf2(noble.sha512, pw, salt, { c: 2048, dkLen: 64 });
}

function generate() {
  var mnemonic = generateMnemonic();
  var seed = mnemonicToSeed(mnemonic);
  var spend = blocknetKeygen(seed.slice(0, 32));
  var view = blocknetKeygen(seed.slice(32, 64));
  var addrBytes = new Uint8Array(64);
  addrBytes.set(spend.pubBytes, 0);
  addrBytes.set(view.pubBytes, 32);
  var address = base58Encode(addrBytes);
  var words = mnemonic.split(" ");

  // Seed grid
  var grid = document.getElementById("seed-grid");
  grid.innerHTML = "";
  for (var i = 0; i < 12; i++) {
    var d = document.createElement("div");
    d.className = "seed-word";
    d.innerHTML = '<span class="seed-num">' + (i+1) + '</span><span class="seed-txt">' + words[i] + '</span>';
    grid.appendChild(d);
  }

  // Keys
  document.getElementById("k-addr").textContent = address;
  document.getElementById("k-spend").textContent = noble.bytesToHex(spend.privBytes);
  document.getElementById("k-view").textContent = noble.bytesToHex(view.privBytes);

  // Serial from first 8 hex chars of address hash
  var serial = noble.bytesToHex(noble.sha256(new TextEncoder().encode(address))).substring(0, 8).toUpperCase();
  document.getElementById("serial").textContent = "No. " + serial;

  // Date
  document.getElementById("gen-date").textContent = new Date().toISOString().split("T")[0] + " \u2022 offline";

  // Show
  document.getElementById("note").classList.add("visible");
  document.getElementById("actions").style.display = "flex";
}
</script>
</body>
</html>
